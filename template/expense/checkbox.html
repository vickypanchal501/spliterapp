{% load static %}


<!-- Required meta tags -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
  integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">



<title>Checkbox #7</title>



<style>
  .checkbox-wrapper-13 {
    margin: 10px;
  }

  @supports (-webkit-appearance: none) or (-moz-appearance: none) {
    .checkbox-wrapper-13 input[type=checkbox] {
      --active: #f8b739;
      --active-inner: #fff;
      --focus: 2px rgba(39, 94, 254, .3);
      --border: #BBC1E1;
      --border-hover: #f8b739;
      --background: #fff;
      --disabled: #F6F8FF;
      --disabled-inner: #E1E6F9;
      -webkit-appearance: none;
      -moz-appearance: none;
      height: 21px;
      outline: none;
      display: inline-block;
      vertical-align: top;
      position: relative;
      margin: 0;
      cursor: pointer;
      border: 1px solid var(--bc, var(--border));
      background: var(--b, var(--background));
      transition: background 0.3s, border-color 0.3s, box-shadow 0.2s;
    }

    .checkbox-wrapper-13 input[type=checkbox]:after {
      content: "";
      display: block;
      left: 0;
      top: 0;
      position: absolute;
      transition: transform var(--d-t, 0.3s) var(--d-t-e, ease), opacity var(--d-o, 0.2s);
    }

    .checkbox-wrapper-13 input[type=checkbox]:checked {
      --b: var(--active);
      --bc: var(--active);
      --d-o: .3s;
      --d-t: .6s;
      --d-t-e: cubic-bezier(.2, .85, .32, 1.2);
    }

    .checkbox-wrapper-13 input[type=checkbox]:disabled {
      --b: var(--disabled);
      cursor: not-allowed;
      opacity: 0.9;
    }

    .checkbox-wrapper-13 input[type=checkbox]:disabled:checked {
      --b: var(--disabled-inner);
      --bc: var(--border);
    }

    .checkbox-wrapper-13 input[type=checkbox]:disabled+label {
      cursor: not-allowed;
    }

    .checkbox-wrapper-13 input[type=checkbox]:hover:not(:checked):not(:disabled) {
      --bc: var(--border-hover);
    }

    .checkbox-wrapper-13 input[type=checkbox]:focus {
      box-shadow: 0 0 0 var(--focus);
    }

    .checkbox-wrapper-13 input[type=checkbox]:not(.switch) {
      width: 21px;
    }

    .checkbox-wrapper-13 input[type=checkbox]:not(.switch):after {
      opacity: var(--o, 0);
    }

    .checkbox-wrapper-13 input[type=checkbox]:not(.switch):checked {
      --o: 1;
    }

    .checkbox-wrapper-13 input[type=checkbox]+label {
      display: inline-block;
      vertical-align: middle;
      cursor: pointer;
      margin-left: 4px;
    }

    .checkbox-wrapper-13 input[type=checkbox]:not(.switch) {
      border-radius: 7px;
    }

    .checkbox-wrapper-13 input[type=checkbox]:not(.switch):after {
      width: 5px;
      height: 9px;
      border: 2px solid var(--active-inner);
      border-top: 0;
      border-left: 0;
      left: 7px;
      top: 4px;
      transform: rotate(var(--r, 20deg));
    }

    .checkbox-wrapper-13 input[type=checkbox]:not(.switch):checked {
      --r: 43deg;
    }
  }

  .checkbox-wrapper-13 * {
    box-sizing: inherit;

  }

  .checkbox-wrapper-13 *:before,
  .checkbox-wrapper-13 *:after {
    box-sizing: inherit;
  }
</style>
<div class="modal fade" id="exampleModalong" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
  aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document" style="max-width: 20%; left: 18%; top: 5%;">
    <div class="modal-content">
      <div class="content">
        <nav>
          <div class="nav nav-tabs" id="nav-tab" role="tablist">
            <a class="nav-item nav-link active" id="nav-home-tab" data-toggle="tab" href="#nav-home" role="tab"
              aria-controls="nav-home" aria-selected="true" onclick="setSplitType('equal')">Equaly</a>
            <a class="nav-item nav-link" id="nav-profile-tab" data-toggle="tab" href="#nav-profile" role="tab"
              aria-controls="nav-profile" aria-selected="false" onclick="setSplitType('percentage')">Percentage</a>

          </div>

          <input type="hidden" name="split_type" id="split_type_input">



          <div class="tab-content" id="split-tab-content">
            <div class="tab-pane fade show active" id="nav-home" role="tabpanel" aria-labelledby="nav-home-tab">
              <div class="checkbox-wrapper-13">
                {% for user in group.members.all %}
                <input id="split_with" type="checkbox" name="split_with" value="{{ user.id }}" checked>
                <label for="split_with">{{ user.username }}</label>
                <br>
                {% endfor %}
              </div>
            </div>

            <div class="tab-pane fade" id="nav-profile" role="tabpanel" aria-labelledby="nav-profile-tab">
              <label for="percentages">Percentages:</label>
              {% for member in group.members.all %}
                  <div class="input-group mb-3">
                      <div class="input-group-prepend" style="width: 60%;">
                          <span class="input-group-text" style="width: 150%;">{{ member.username }}</span>
                      </div>
                      <input style="display: flex; justify-content: end; max-width: 30%;"
                          name="contributions[{{ member.username }}]" type="text" class="form-control"
                          aria-label="Amount (to the nearest dollar)" id="percentage-{{ member.id }}">
                      <div class="input-group-append">
                          <span class="input-group-text">%</span>
                      </div>
                  </div>
                 
              {% endfor %}
              <div>
                  <span>Total Percentage: <span id="total-percentage">0.00%</span></span>
              </div>
          </div>
          </div>
        </nav>

      </div>
    </div>
  </div>
</div>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>
  function setSplitType(splitType) {
    console.log("Selected Split Type:", splitType);
    // Set the selected split type in the hidden input
    $("#split_type_input").val(splitType);
  }
  function updateTotalPercentage() {
            const totalPercentageField = $("#total-percentage");
            const totalPercentage = Array.from($("input[id^='percentage']"))
                .map(input => parseFloat($(input).val()) || 0)
                .reduce((acc, percentage) => acc + percentage, 0);

            totalPercentageField.text(totalPercentage.toFixed(2) + "%");

            // Change color based on whether the total percentage is above or below 100%
            totalPercentageField.css("color", totalPercentage > 100 ? "red" : "green");
        }

        // Update the total percentage whenever there is a change in the percentage inputs
        $("input[id^='percentage']").on("input", updateTotalPercentage);
</script>


<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
  integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"
  integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
  integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>